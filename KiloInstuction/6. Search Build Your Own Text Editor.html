<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>6. Search | Build Your Own Text Editor</title>
    <link href="6.%20Search%20Build%20Your%20Own%20Text%20Editor_files/style.css" rel="stylesheet">
  <style id="zoomLevel-styles"></style></head>
  <body data-new-gr-c-s-check-loaded="8.906.0" data-gr-ext-installed="" style="font-size: 18px !important; line-height: 25.2px !important;">
    <header class="bar" style="font-size: 18px !important; line-height: 25.2px !important;">
      <nav style="font-size: 18px !important; line-height: 25.2px !important;">
        <a href="https://viewsourcecode.org/snaptoken/kilo/05.aTextEditor.html" style="font-size: 18px !important; line-height: 25.2px !important;">← prev</a>
        <a href="https://viewsourcecode.org/snaptoken/kilo/index.html" style="font-size: 18px !important; line-height: 25.2px !important;">contents</a>
        <a href="https://viewsourcecode.org/snaptoken/kilo/07.syntaxHighlighting.html" style="font-size: 18px !important; line-height: 25.2px !important;">next →</a>
      </nav>
    </header>
    <div id="container" style="font-size: 18px !important; line-height: 25.2px !important;">
      <h1 id="search" style="font-size: 38px !important; line-height: 38px !important;">Search</h1>

<p style="font-size: 18px !important; line-height: 25.2px !important;">Let’s use <code style="font-size: 18px !important; line-height: 25.2px !important;">editorPrompt()</code> to implement a minimal search feature. When the user
types a search query and presses <kbd style="font-size: 14px !important; line-height: 25.2px !important;">Enter</kbd>, we’ll loop through all the
rows of the file, and if a row contains their query string, we’ll move the
cursor to the match.</p>

<div class="diff" style="font-size: 18px !important; line-height: 25.2px !important;">
<div class="diff-header" style="font-size: 16px !important; line-height: 25.2px !important;">
  <div class="step-filename" style="font-size: 16px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/blob/basic-search/kilo.c" style="font-size: 16px !important; line-height: 25.2px !important;">kilo.c</a></div>
  <div class="step-number" style="font-size: 16px !important; line-height: 25.2px !important;">Step 131</div>
  <div class="step-name" style="font-size: 12px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/tree/basic-search" style="font-size: 12px !important; line-height: 25.2px !important;">basic-search</a></div>
</div><pre class="highlight" style="font-size: 18px !important; line-height: 25.2px !important;"><code style="font-size: 14px !important; line-height: 20px !important;"><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** includes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** defines ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** data ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** prototypes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** terminal ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** row operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** editor operations ***/</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** file i/o ***/</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorRowsToString</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">buflen</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorOpen</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">filename</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorSave</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">()</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** find ***/</span></ins><ins class="line" style="font-size: 14px !important;"></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorFind</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">()</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorPrompt</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="s" style="font-size: 14px !important; line-height: 20px !important;">"Search: %s (ESC to cancel)"</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="nb" style="font-size: 14px !important; line-height: 20px !important;">NULL</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">return</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important;"></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">for</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">0</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&lt;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">numrows</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">++</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">erow</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&amp;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">[</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">];</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">strstr</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">-&gt;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">render</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">match</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cy</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">-&gt;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">render</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">rowoff</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">numrows</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">break</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></ins><ins class="line" style="font-size: 14px !important;"></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="n" style="font-size: 14px !important; line-height: 20px !important;">free</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></ins><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** append buffer ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** output ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** input ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** init ***/</span></div></code></pre>
<div class="diff-footer" style="font-size: 18px !important; line-height: 25.2px !important;">
  <div class="diff-tag-c1" style="font-size: 12px !important; line-height: 16px !important;">♎︎ compiles, but with no observable effects</div>
</div>
</div>


<p style="font-size: 18px !important; line-height: 25.2px !important;"><code style="font-size: 18px !important; line-height: 25.2px !important;">strstr()</code> comes from <code style="font-size: 18px !important; line-height: 25.2px !important;">&lt;string.h&gt;</code>.</p>

<p style="font-size: 18px !important; line-height: 25.2px !important;">If they pressed <kbd style="font-size: 14px !important; line-height: 25.2px !important;">Escape</kbd> to cancel the input prompt, then
<code style="font-size: 18px !important; line-height: 25.2px !important;">editorPrompt()</code> returns <code style="font-size: 18px !important; line-height: 25.2px !important;">NULL</code> and we abort the search.</p>

<p style="font-size: 18px !important; line-height: 25.2px !important;">Otherwise, we loop through all the rows of the file. We use <code style="font-size: 18px !important; line-height: 25.2px !important;">strstr()</code> to check
if <code style="font-size: 18px !important; line-height: 25.2px !important;">query</code> is a substring of the current row. It returns <code style="font-size: 18px !important; line-height: 25.2px !important;">NULL</code> if there is no
match, otherwise it returns a pointer to the matching substring. To convert
that into an index that we can set <code style="font-size: 18px !important; line-height: 25.2px !important;">E.cx</code> to, we subtract the <code style="font-size: 18px !important; line-height: 25.2px !important;">row-&gt;render</code>
pointer from the <code style="font-size: 18px !important; line-height: 25.2px !important;">match</code> pointer, since <code style="font-size: 18px !important; line-height: 25.2px !important;">match</code> is a pointer into the
<code style="font-size: 18px !important; line-height: 25.2px !important;">row-&gt;render</code> string. Lastly, we set <code style="font-size: 18px !important; line-height: 25.2px !important;">E.rowoff</code> so that we are scrolled to the
very bottom of the file, which will cause <code style="font-size: 18px !important; line-height: 25.2px !important;">editorScroll()</code> to scroll upwards at
the next screen refresh so that the matching line will be at the very top of
the screen. This way, the user doesn’t have to look all over their screen to
find where their cursor jumped to, and where the matching line is.</p>

<p style="font-size: 18px !important; line-height: 25.2px !important;">There’s one problem here. Did you notice what we just did wrong? We assigned a
<code style="font-size: 18px !important; line-height: 25.2px !important;">render</code> index to <code style="font-size: 18px !important; line-height: 25.2px !important;">E.cx</code>, but <code style="font-size: 18px !important; line-height: 25.2px !important;">E.cx</code> is an index into <code style="font-size: 18px !important; line-height: 25.2px !important;">chars</code>. If there are
tabs to the left of the match, the cursor is going to be in the wrong position.
We need to convert the <code style="font-size: 18px !important; line-height: 25.2px !important;">render</code> index into a <code style="font-size: 18px !important; line-height: 25.2px !important;">chars</code> index before assigning it
to <code style="font-size: 18px !important; line-height: 25.2px !important;">E.cx</code>. Let’s create an <code style="font-size: 18px !important; line-height: 25.2px !important;">editorRowRxToCx()</code> function, which is the opposite
of the <code style="font-size: 18px !important; line-height: 25.2px !important;">editorRowCxToRx()</code> function we wrote in
<a href="https://viewsourcecode.org/snaptoken/kilo/04.aTextViewer.html#tabs-and-the-cursor" style="font-size: 18px !important; line-height: 25.2px !important;">chapter 4</a>, but contains a lot of the
same code.</p>

<div class="diff" style="font-size: 18px !important; line-height: 25.2px !important;">
<div class="diff-header" style="font-size: 16px !important; line-height: 25.2px !important;">
  <div class="step-filename" style="font-size: 16px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/blob/rx-to-cx/kilo.c" style="font-size: 16px !important; line-height: 25.2px !important;">kilo.c</a></div>
  <div class="step-number" style="font-size: 16px !important; line-height: 25.2px !important;">Step 132</div>
  <div class="step-name" style="font-size: 12px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/tree/rx-to-cx" style="font-size: 12px !important; line-height: 25.2px !important;">rx-to-cx</a></div>
</div><pre class="highlight" style="font-size: 18px !important; line-height: 25.2px !important;"><code style="font-size: 14px !important; line-height: 20px !important;"><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** includes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** defines ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** data ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** prototypes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** terminal ***/</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** row operations ***/</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorRowCxToRx</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">erow</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorRowRxToCx</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">erow</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">rx</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">cur_rx</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">0</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">for</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">0</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&lt;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">-&gt;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">size</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">++</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">-&gt;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">chars</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">[</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">]</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'\t'</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">cur_rx</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">+=</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">KILO_TAB_STOP</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cur_rx</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">%</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">KILO_TAB_STOP</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">cur_rx</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">++</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important;"></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cur_rx</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&gt;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">rx</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">return</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">return</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></ins><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorUpdateRow</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">erow</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorInsertRow</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">at</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">s</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">size_t</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">len</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorFreeRow</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">erow</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorDelRow</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">at</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorRowInsertChar</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">erow</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">at</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorRowAppendString</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">erow</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">s</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">size_t</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">len</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorRowDelChar</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">erow</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">at</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** editor operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** file i/o ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** find ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** append buffer ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** output ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** input ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** init ***/</span></div></code></pre>
<div class="diff-footer" style="font-size: 18px !important; line-height: 25.2px !important;">
  <div class="diff-tag-c1" style="font-size: 12px !important; line-height: 16px !important;">♎︎ compiles, but with no observable effects</div>
</div>
</div>


<p style="font-size: 18px !important; line-height: 25.2px !important;">To convert an <code style="font-size: 18px !important; line-height: 25.2px !important;">rx</code> into a <code style="font-size: 18px !important; line-height: 25.2px !important;">cx</code>, we do pretty much the same thing when
converting the other way: loop through the <code style="font-size: 18px !important; line-height: 25.2px !important;">chars</code> string, calculating the
current <code style="font-size: 18px !important; line-height: 25.2px !important;">rx</code> value (<code style="font-size: 18px !important; line-height: 25.2px !important;">cur_rx</code>) as we go. But instead of stopping when we hit a
particular <code style="font-size: 18px !important; line-height: 25.2px !important;">cx</code> value and returning <code style="font-size: 18px !important; line-height: 25.2px !important;">cur_rx</code>, we want to stop when <code style="font-size: 18px !important; line-height: 25.2px !important;">cur_rx</code>
hits the given <code style="font-size: 18px !important; line-height: 25.2px !important;">rx</code> value and return <code style="font-size: 18px !important; line-height: 25.2px !important;">cx</code>.</p>

<p style="font-size: 18px !important; line-height: 25.2px !important;">The <code style="font-size: 18px !important; line-height: 25.2px !important;">return</code> statement at the very end is just in case the caller provided an
<code style="font-size: 18px !important; line-height: 25.2px !important;">rx</code> that’s out of range, which shouldn’t happen. The <code style="font-size: 18px !important; line-height: 25.2px !important;">return</code> statement inside
the <code style="font-size: 18px !important; line-height: 25.2px !important;">for</code> loop should handle all <code style="font-size: 18px !important; line-height: 25.2px !important;">rx</code> values that are valid indexes into
<code style="font-size: 18px !important; line-height: 25.2px !important;">render</code>.</p>

<p style="font-size: 18px !important; line-height: 25.2px !important;">Now let’s call <code style="font-size: 18px !important; line-height: 25.2px !important;">editorRowRxToCx()</code> to convert the matched index to a <code style="font-size: 18px !important; line-height: 25.2px !important;">chars</code>
index and assign that to <code style="font-size: 18px !important; line-height: 25.2px !important;">E.cx</code>.</p>

<div class="diff" style="font-size: 18px !important; line-height: 25.2px !important;">
<div class="diff-header" style="font-size: 16px !important; line-height: 25.2px !important;">
  <div class="step-filename" style="font-size: 16px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/blob/use-rx-to-cx/kilo.c" style="font-size: 16px !important; line-height: 25.2px !important;">kilo.c</a></div>
  <div class="step-number" style="font-size: 16px !important; line-height: 25.2px !important;">Step 133</div>
  <div class="step-name" style="font-size: 12px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/tree/use-rx-to-cx" style="font-size: 12px !important; line-height: 25.2px !important;">use-rx-to-cx</a></div>
</div><pre class="highlight" style="font-size: 18px !important; line-height: 25.2px !important;"><code style="font-size: 14px !important; line-height: 20px !important;"><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** includes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** defines ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** data ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** prototypes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** terminal ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** row operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** editor operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** file i/o ***/</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** find ***/</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorFind</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">()</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorPrompt</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="s" style="font-size: 14px !important; line-height: 20px !important;">"Search: %s (ESC to cancel)"</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="nb" style="font-size: 14px !important; line-height: 20px !important;">NULL</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">return</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">for</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">0</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&lt;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">numrows</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">++</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">erow</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&amp;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">[</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">];</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">strstr</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">-&gt;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">render</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">match</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cy</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorRowRxToCx</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">-&gt;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">render</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></ins><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">rowoff</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">numrows</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">break</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="n" style="font-size: 14px !important; line-height: 20px !important;">free</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** append buffer ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** output ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** input ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** init ***/</span></div></code></pre>
<div class="diff-footer" style="font-size: 18px !important; line-height: 25.2px !important;">
  <div class="diff-tag-c1" style="font-size: 12px !important; line-height: 16px !important;">♎︎ compiles, but with no observable effects</div>
</div>
</div>


<p style="font-size: 18px !important; line-height: 25.2px !important;">Finally, let’s map <kbd style="font-size: 14px !important; line-height: 25.2px !important;">Ctrl-F</kbd> to the <code style="font-size: 18px !important; line-height: 25.2px !important;">editorFind()</code> function, and add it
to the help message we set in <code style="font-size: 18px !important; line-height: 25.2px !important;">main()</code>.</p>

<div class="diff" style="font-size: 18px !important; line-height: 25.2px !important;">
<div class="diff-header" style="font-size: 16px !important; line-height: 25.2px !important;">
  <div class="step-filename" style="font-size: 16px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/blob/ctrl-f/kilo.c" style="font-size: 16px !important; line-height: 25.2px !important;">kilo.c</a></div>
  <div class="step-number" style="font-size: 16px !important; line-height: 25.2px !important;">Step 134</div>
  <div class="step-name" style="font-size: 12px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/tree/ctrl-f" style="font-size: 12px !important; line-height: 25.2px !important;">ctrl-f</a></div>
</div><pre class="highlight" style="font-size: 18px !important; line-height: 25.2px !important;"><code style="font-size: 14px !important; line-height: 20px !important;"><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** includes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** defines ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** data ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** prototypes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** terminal ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** row operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** editor operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** file i/o ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** find ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** append buffer ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** output ***/</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** input ***/</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorPrompt</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">prompt</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorMoveCursor</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorProcessKeypress</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">()</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">static</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">quit_times</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">KILO_QUIT_TIMES</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorReadKey</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">();</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">switch</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">case</span> <span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'\r'</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">:</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorInsertNewline</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">();</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">break</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">case</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">CTRL_KEY</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'q'</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">):</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">dirty</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&amp;&amp;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">quit_times</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&gt;</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">0</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorSetStatusMessage</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="s" style="font-size: 14px !important; line-height: 20px !important;">"WARNING!!! File has unsaved changes. "</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">          <span class="s" style="font-size: 14px !important; line-height: 20px !important;">"Press Ctrl-Q %d more times to quit."</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">quit_times</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="n" style="font-size: 14px !important; line-height: 20px !important;">quit_times</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">--</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="k" style="font-size: 14px !important; line-height: 20px !important;">return</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">write</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">STDOUT_FILENO</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="s" style="font-size: 14px !important; line-height: 20px !important;">"</span><span class="se" style="font-size: 14px !important; line-height: 20px !important;">\x1b</span><span class="s" style="font-size: 14px !important; line-height: 20px !important;">[2J"</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">4</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">write</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">STDOUT_FILENO</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="s" style="font-size: 14px !important; line-height: 20px !important;">"</span><span class="se" style="font-size: 14px !important; line-height: 20px !important;">\x1b</span><span class="s" style="font-size: 14px !important; line-height: 20px !important;">[H"</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">3</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">exit</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="mi" style="font-size: 14px !important; line-height: 20px !important;">0</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">break</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">case</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">CTRL_KEY</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'s'</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">):</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorSave</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">();</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">break</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">case</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">HOME_KEY</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">:</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">0</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">break</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">case</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">END_KEY</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">:</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cy</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&lt;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">numrows</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">[</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cy</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">].</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">size</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">break</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important;"></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">case</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">CTRL_KEY</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'f'</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">):</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorFind</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">();</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">break</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">case</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">BACKSPACE</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">:</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">case</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">CTRL_KEY</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'h'</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">):</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">case</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">DEL_KEY</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">:</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">DEL_KEY</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorMoveCursor</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">ARROW_RIGHT</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorDelChar</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">();</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">break</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">case</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">PAGE_UP</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">:</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">case</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">PAGE_DOWN</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">:</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">PAGE_UP</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">          <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cy</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">rowoff</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">else</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">PAGE_DOWN</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">          <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cy</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">rowoff</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">+</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">screenrows</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">          <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cy</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&gt;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">numrows</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cy</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">numrows</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">times</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">screenrows</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="k" style="font-size: 14px !important; line-height: 20px !important;">while</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">times</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">--</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">          <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorMoveCursor</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">PAGE_UP</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">?</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">ARROW_UP</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">:</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">ARROW_DOWN</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">break</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">case</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">ARROW_UP</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">:</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">case</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">ARROW_DOWN</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">:</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">case</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">ARROW_LEFT</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">:</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">case</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">ARROW_RIGHT</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">:</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorMoveCursor</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">break</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">case</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">CTRL_KEY</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'l'</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">):</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">case</span> <span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'\x1b'</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">:</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">break</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="nl" style="font-size: 14px !important; line-height: 20px !important;">default:</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorInsertChar</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">break</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="n" style="font-size: 14px !important; line-height: 20px !important;">quit_times</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">KILO_QUIT_TIMES</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** init ***/</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">initEditor</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">()</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">main</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">argc</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">argv</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">[])</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="n" style="font-size: 14px !important; line-height: 20px !important;">enableRawMode</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">();</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="n" style="font-size: 14px !important; line-height: 20px !important;">initEditor</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">();</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">argc</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&gt;=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">2</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorOpen</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">argv</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">[</span><span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">]);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorSetStatusMessage</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="s" style="font-size: 14px !important; line-height: 20px !important;">"HELP: Ctrl-S = save | Ctrl-Q = quit | Ctrl-F = find"</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></ins><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">while</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorRefreshScreen</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">();</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorProcessKeypress</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">();</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">return</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">0</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div></code></pre>
<div class="diff-footer" style="font-size: 18px !important; line-height: 25.2px !important;">
  <div class="diff-tag-c2" style="font-size: 12px !important; line-height: 16px !important;">♐︎ compiles</div>
</div>
</div>

<h2 id="incremental-search" style="font-size: 26px !important; line-height: 26px !important;"><a href="#incremental-search" style="font-size: 26px !important; line-height: 26px !important;">Incremental search</a></h2>

<p style="font-size: 18px !important; line-height: 25.2px !important;">Now, let’s make our search feature fancy. We want to support incremental
search, meaning the file is searched after each keypress when the user is
typing in their search query.</p>

<p style="font-size: 18px !important; line-height: 25.2px !important;">To implement this, we’re going to get <code style="font-size: 18px !important; line-height: 25.2px !important;">editorPrompt()</code> to take a callback
function as an argument. We’ll have it call this function after each keypress,
passing the current search query inputted by the user and the last key they
pressed.</p>

<div class="diff" style="font-size: 18px !important; line-height: 25.2px !important;">
<div class="diff-header" style="font-size: 16px !important; line-height: 25.2px !important;">
  <div class="step-filename" style="font-size: 16px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/blob/prompt-callback/kilo.c" style="font-size: 16px !important; line-height: 25.2px !important;">kilo.c</a></div>
  <div class="step-number" style="font-size: 16px !important; line-height: 25.2px !important;">Step 135</div>
  <div class="step-name" style="font-size: 12px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/tree/prompt-callback" style="font-size: 12px !important; line-height: 25.2px !important;">prompt-callback</a></div>
</div><pre class="highlight" style="font-size: 18px !important; line-height: 25.2px !important;"><code style="font-size: 14px !important; line-height: 20px !important;"><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** includes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** defines ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** data ***/</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** prototypes ***/</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorSetStatusMessage</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="k" style="font-size: 14px !important; line-height: 20px !important;">const</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">fmt</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">...);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorRefreshScreen</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">();</span></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorPrompt</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">prompt</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">callback</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">));</span></ins><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** terminal ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** row operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** editor operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** file i/o ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** find ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** append buffer ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** output ***/</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** input ***/</span></div><div class="line" style="font-size: 14px !important;"></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorPrompt</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">prompt</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">callback</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">))</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></ins><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">size_t</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">bufsize</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">128</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">buf</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">malloc</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">bufsize</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">size_t</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">buflen</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">0</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="n" style="font-size: 14px !important; line-height: 20px !important;">buf</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">[</span><span class="mi" style="font-size: 14px !important; line-height: 20px !important;">0</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">]</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'\0'</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">while</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorSetStatusMessage</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">prompt</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">buf</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorRefreshScreen</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">();</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorReadKey</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">();</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">DEL_KEY</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">||</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">CTRL_KEY</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'h'</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">||</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">BACKSPACE</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">buflen</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">!=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">0</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">buf</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">[</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">--</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">buflen</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">]</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'\0'</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">else</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'\x1b'</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorSetStatusMessage</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="s" style="font-size: 14px !important; line-height: 20px !important;">""</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">callback</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">callback</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">buf</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></ins><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">free</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">buf</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">return</span> <span class="nb" style="font-size: 14px !important; line-height: 20px !important;">NULL</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">else</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'\r'</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">buflen</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">!=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">0</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorSetStatusMessage</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="s" style="font-size: 14px !important; line-height: 20px !important;">""</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">callback</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">callback</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">buf</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></ins><div class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="k" style="font-size: 14px !important; line-height: 20px !important;">return</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">buf</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">else</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">!</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">iscntrl</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&amp;&amp;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&lt;</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">128</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">buflen</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">bufsize</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="n" style="font-size: 14px !important; line-height: 20px !important;">bufsize</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">2</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="n" style="font-size: 14px !important; line-height: 20px !important;">buf</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">realloc</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">buf</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">bufsize</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">buf</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">[</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">buflen</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">++</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">]</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">buf</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">[</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">buflen</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">]</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'\0'</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">callback</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">callback</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">buf</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">c</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></ins><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorMoveCursor</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorProcessKeypress</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">()</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** init ***/</span></div></code></pre>
<div class="diff-footer" style="font-size: 18px !important; line-height: 25.2px !important;">
  <div class="diff-tag-c0" style="font-size: 12px !important; line-height: 16px !important;">♏︎ doesn’t compile</div>
</div>
</div>


<p style="font-size: 18px !important; line-height: 25.2px !important;">The <code style="font-size: 18px !important; line-height: 25.2px !important;">if</code> statements allow the caller to pass <code style="font-size: 18px !important; line-height: 25.2px !important;">NULL</code> for the callback, in case
they don’t want to use a callback. This is the case when we prompt the user
for a filename, so let’s pass <code style="font-size: 18px !important; line-height: 25.2px !important;">NULL</code> to <code style="font-size: 18px !important; line-height: 25.2px !important;">editorPrompt()</code> when we do that. We’ll
also pass <code style="font-size: 18px !important; line-height: 25.2px !important;">NULL</code> to <code style="font-size: 18px !important; line-height: 25.2px !important;">editorPrompt()</code> in <code style="font-size: 18px !important; line-height: 25.2px !important;">editorFind()</code> for now, to get the code
to compile.</p>

<div class="diff" style="font-size: 18px !important; line-height: 25.2px !important;">
<div class="diff-header" style="font-size: 16px !important; line-height: 25.2px !important;">
  <div class="step-filename" style="font-size: 16px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/blob/null-callback/kilo.c" style="font-size: 16px !important; line-height: 25.2px !important;">kilo.c</a></div>
  <div class="step-number" style="font-size: 16px !important; line-height: 25.2px !important;">Step 136</div>
  <div class="step-name" style="font-size: 12px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/tree/null-callback" style="font-size: 12px !important; line-height: 25.2px !important;">null-callback</a></div>
</div><pre class="highlight" style="font-size: 18px !important; line-height: 25.2px !important;"><code style="font-size: 14px !important; line-height: 20px !important;"><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** includes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** defines ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** data ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** prototypes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** terminal ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** row operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** editor operations ***/</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** file i/o ***/</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorRowsToString</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">buflen</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorOpen</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">filename</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorSave</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">()</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">filename</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="nb" style="font-size: 14px !important; line-height: 20px !important;">NULL</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">filename</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorPrompt</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="s" style="font-size: 14px !important; line-height: 20px !important;">"Save as: %s (ESC to cancel)"</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="nb" style="font-size: 14px !important; line-height: 20px !important;">NULL</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></ins><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">filename</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="nb" style="font-size: 14px !important; line-height: 20px !important;">NULL</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorSetStatusMessage</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="s" style="font-size: 14px !important; line-height: 20px !important;">"Save aborted"</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">return</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">len</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">buf</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorRowsToString</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">&amp;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">len</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">fd</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">open</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">filename</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">O_RDWR</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">|</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">O_CREAT</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="mo" style="font-size: 14px !important; line-height: 20px !important;">0644</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">fd</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">!=</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span><span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">ftruncate</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">fd</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">len</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">!=</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span><span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">write</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">fd</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">buf</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">len</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">len</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="n" style="font-size: 14px !important; line-height: 20px !important;">close</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">fd</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="n" style="font-size: 14px !important; line-height: 20px !important;">free</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">buf</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">dirty</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">0</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorSetStatusMessage</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="s" style="font-size: 14px !important; line-height: 20px !important;">"%d bytes written to disk"</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">len</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">        <span class="k" style="font-size: 14px !important; line-height: 20px !important;">return</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">close</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">fd</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="n" style="font-size: 14px !important; line-height: 20px !important;">free</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">buf</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorSetStatusMessage</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="s" style="font-size: 14px !important; line-height: 20px !important;">"Can't save! I/O error: %s"</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">strerror</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">errno</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">));</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** find ***/</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorFind</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">()</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorPrompt</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="s" style="font-size: 14px !important; line-height: 20px !important;">"Search: %s (ESC to cancel)"</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="nb" style="font-size: 14px !important; line-height: 20px !important;">NULL</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></ins><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="nb" style="font-size: 14px !important; line-height: 20px !important;">NULL</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">return</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">for</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">0</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&lt;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">numrows</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">++</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">erow</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&amp;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">[</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">];</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">strstr</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">-&gt;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">render</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">match</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cy</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorRowRxToCx</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">-&gt;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">render</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">rowoff</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">numrows</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">break</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="n" style="font-size: 14px !important; line-height: 20px !important;">free</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** append buffer ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** output ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** input ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** init ***/</span></div></code></pre>
<div class="diff-footer" style="font-size: 18px !important; line-height: 25.2px !important;">
  <div class="diff-tag-c1" style="font-size: 12px !important; line-height: 16px !important;">♎︎ compiles, but with no observable effects</div>
</div>
</div>


<p style="font-size: 18px !important; line-height: 25.2px !important;">Now let’s move the actual searching code from <code style="font-size: 18px !important; line-height: 25.2px !important;">editorFind()</code> into a function
called <code style="font-size: 18px !important; line-height: 25.2px !important;">editorFindCallback()</code>. Obviously this will be our callback function for
<code style="font-size: 18px !important; line-height: 25.2px !important;">editorPrompt()</code>.</p>

<div class="diff" style="font-size: 18px !important; line-height: 25.2px !important;">
<div class="diff-header" style="font-size: 16px !important; line-height: 25.2px !important;">
  <div class="step-filename" style="font-size: 16px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/blob/incremental-search/kilo.c" style="font-size: 16px !important; line-height: 25.2px !important;">kilo.c</a></div>
  <div class="step-number" style="font-size: 16px !important; line-height: 25.2px !important;">Step 137</div>
  <div class="step-name" style="font-size: 12px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/tree/incremental-search" style="font-size: 12px !important; line-height: 25.2px !important;">incremental-search</a></div>
</div><pre class="highlight" style="font-size: 18px !important; line-height: 25.2px !important;"><code style="font-size: 14px !important; line-height: 20px !important;"><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** includes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** defines ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** data ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** prototypes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** terminal ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** row operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** editor operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** file i/o ***/</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** find ***/</span></div><div class="line" style="font-size: 14px !important;"></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorFindCallback</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'\r'</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">||</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'\x1b'</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">return</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></ins><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">for</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">0</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&lt;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">numrows</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">++</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">erow</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&amp;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">[</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">];</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">strstr</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">-&gt;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">render</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">match</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cy</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorRowRxToCx</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">-&gt;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">render</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">rowoff</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">numrows</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">break</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></ins><div class="line" style="font-size: 14px !important;"></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorFind</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">()</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorPrompt</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="s" style="font-size: 14px !important; line-height: 20px !important;">"Search: %s (ESC to cancel)"</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorFindCallback</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></ins><ins class="line" style="font-size: 14px !important;"></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></ins><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">free</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></ins><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** append buffer ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** output ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** input ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** init ***/</span></div></code></pre>
<div class="diff-footer" style="font-size: 18px !important; line-height: 25.2px !important;">
  <div class="diff-tag-c2" style="font-size: 12px !important; line-height: 16px !important;">♐︎ compiles</div>
</div>
</div>


<p style="font-size: 18px !important; line-height: 25.2px !important;">In the callback, we check if the user pressed <kbd style="font-size: 14px !important; line-height: 25.2px !important;">Enter</kbd> or
<kbd style="font-size: 14px !important; line-height: 25.2px !important;">Escape</kbd>, in which case they are leaving search mode so we <code style="font-size: 18px !important; line-height: 25.2px !important;">return</code>
immediately instead of doing another search. Otherwise, after any other
keypress, we do another search for the current <code style="font-size: 18px !important; line-height: 25.2px !important;">query</code> string.</p>

<p style="font-size: 18px !important; line-height: 25.2px !important;">That’s all there is to it. We now have incremental search.</p>
<h2 id="restore-cursor-position-when-cancelling-search" style="font-size: 26px !important; line-height: 26px !important;"><a href="#restore-cursor-position-when-cancelling-search" style="font-size: 26px !important; line-height: 26px !important;">Restore cursor position when cancelling search</a></h2>

<p style="font-size: 18px !important; line-height: 25.2px !important;">When the user presses <kbd style="font-size: 14px !important; line-height: 25.2px !important;">Escape</kbd> to cancel a search, we want the cursor
to go back to where it was when they started the search. To do that, we’ll have
to save their cursor position and scroll position, and restore those values
after the search is cancelled.</p>

<div class="diff" style="font-size: 18px !important; line-height: 25.2px !important;">
<div class="diff-header" style="font-size: 16px !important; line-height: 25.2px !important;">
  <div class="step-filename" style="font-size: 16px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/blob/restore-cursor/kilo.c" style="font-size: 16px !important; line-height: 25.2px !important;">kilo.c</a></div>
  <div class="step-number" style="font-size: 16px !important; line-height: 25.2px !important;">Step 138</div>
  <div class="step-name" style="font-size: 12px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/tree/restore-cursor" style="font-size: 12px !important; line-height: 25.2px !important;">restore-cursor</a></div>
</div><pre class="highlight" style="font-size: 18px !important; line-height: 25.2px !important;"><code style="font-size: 14px !important; line-height: 20px !important;"><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** includes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** defines ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** data ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** prototypes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** terminal ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** row operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** editor operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** file i/o ***/</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** find ***/</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorFindCallback</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorFind</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">()</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">saved_cx</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">saved_cy</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cy</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">saved_coloff</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">coloff</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">saved_rowoff</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">rowoff</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorPrompt</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="s" style="font-size: 14px !important; line-height: 20px !important;">"Search: %s (ESC to cancel)"</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorFindCallback</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">free</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">else</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">saved_cx</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cy</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">saved_cy</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">coloff</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">saved_coloff</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">rowoff</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">saved_rowoff</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** append buffer ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** output ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** input ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** init ***/</span></div></code></pre>
<div class="diff-footer" style="font-size: 18px !important; line-height: 25.2px !important;">
  <div class="diff-tag-c2" style="font-size: 12px !important; line-height: 16px !important;">♐︎ compiles</div>
</div>
</div>


<p style="font-size: 18px !important; line-height: 25.2px !important;">If <code style="font-size: 18px !important; line-height: 25.2px !important;">query</code> is <code style="font-size: 18px !important; line-height: 25.2px !important;">NULL</code>, that means they pressed <kbd style="font-size: 14px !important; line-height: 25.2px !important;">Escape</kbd>, so in that
case we restore the values we saved.</p>
<h2 id="search-forward-and-backward" style="font-size: 26px !important; line-height: 26px !important;"><a href="#search-forward-and-backward" style="font-size: 26px !important; line-height: 26px !important;">Search forward and backward</a></h2>

<p style="font-size: 18px !important; line-height: 25.2px !important;">The last feature we’d like to add is to allow the user to advance to the next
or previous match in the file using the arrow keys. The <kbd style="font-size: 14px !important; line-height: 25.2px !important;">↑</kbd> and
<kbd style="font-size: 14px !important; line-height: 25.2px !important;">←</kbd> keys will go to the previous match, and the <kbd style="font-size: 14px !important; line-height: 25.2px !important;">↓</kbd>
and <kbd style="font-size: 14px !important; line-height: 25.2px !important;">→</kbd> keys will go to the next match.</p>

<p style="font-size: 18px !important; line-height: 25.2px !important;">We’ll implement this feature using two static variables in our callback.
<code style="font-size: 18px !important; line-height: 25.2px !important;">last_match</code> will contain the index of the row that the last match was on, or
<code style="font-size: 18px !important; line-height: 25.2px !important;">-1</code> if there was no last match. And <code style="font-size: 18px !important; line-height: 25.2px !important;">direction</code> will store the direction of
the search: <code style="font-size: 18px !important; line-height: 25.2px !important;">1</code> for searching forward, and <code style="font-size: 18px !important; line-height: 25.2px !important;">-1</code> for searching backward.</p>

<div class="diff" style="font-size: 18px !important; line-height: 25.2px !important;">
<div class="diff-header" style="font-size: 16px !important; line-height: 25.2px !important;">
  <div class="step-filename" style="font-size: 16px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/blob/callback-statics/kilo.c" style="font-size: 16px !important; line-height: 25.2px !important;">kilo.c</a></div>
  <div class="step-number" style="font-size: 16px !important; line-height: 25.2px !important;">Step 139</div>
  <div class="step-name" style="font-size: 12px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/tree/callback-statics" style="font-size: 12px !important; line-height: 25.2px !important;">callback-statics</a></div>
</div><pre class="highlight" style="font-size: 18px !important; line-height: 25.2px !important;"><code style="font-size: 14px !important; line-height: 20px !important;"><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** includes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** defines ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** data ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** prototypes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** terminal ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** row operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** editor operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** file i/o ***/</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** find ***/</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorFindCallback</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">static</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">last_match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span><span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">static</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">direction</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'\r'</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">||</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'\x1b'</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">last_match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span><span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">direction</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">return</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">else</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">ARROW_RIGHT</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">||</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">ARROW_DOWN</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">direction</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">else</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">ARROW_LEFT</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">||</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">ARROW_UP</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">direction</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span><span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">else</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">last_match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span><span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">direction</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">for</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">0</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&lt;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">numrows</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">++</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">erow</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&amp;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">[</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">];</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">strstr</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">-&gt;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">render</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">match</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cy</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorRowRxToCx</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">-&gt;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">render</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">rowoff</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">numrows</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">break</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorFind</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">()</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** append buffer ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** output ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** input ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** init ***/</span></div></code></pre>
<div class="diff-footer" style="font-size: 18px !important; line-height: 25.2px !important;">
  <div class="diff-tag-c1" style="font-size: 12px !important; line-height: 16px !important;">♎︎ compiles, but with no observable effects</div>
</div>
</div>


<p style="font-size: 18px !important; line-height: 25.2px !important;">As you can see, we always reset <code style="font-size: 18px !important; line-height: 25.2px !important;">last_match</code> to <code style="font-size: 18px !important; line-height: 25.2px !important;">-1</code> unless an arrow key was
pressed. So we’ll only advance to the next or previous match when an arrow key
is pressed. You can also see that we always set <code style="font-size: 18px !important; line-height: 25.2px !important;">direction</code> to <code style="font-size: 18px !important; line-height: 25.2px !important;">1</code> unless the
<kbd style="font-size: 14px !important; line-height: 25.2px !important;">←</kbd> or <kbd style="font-size: 14px !important; line-height: 25.2px !important;">↑</kbd> key was pressed. So we always search in
the forward direction unless the user specifically asks to search backwards
from the last match.</p>

<p style="font-size: 18px !important; line-height: 25.2px !important;">If <code style="font-size: 18px !important; line-height: 25.2px !important;">key</code> is <code style="font-size: 18px !important; line-height: 25.2px !important;">'\r'</code> (<kbd style="font-size: 14px !important; line-height: 25.2px !important;">Enter</kbd>) or <code style="font-size: 18px !important; line-height: 25.2px !important;">'\x1b'</code> (<kbd style="font-size: 14px !important; line-height: 25.2px !important;">Escape</kbd>), that
means we’re about to leave search mode. So we reset <code style="font-size: 18px !important; line-height: 25.2px !important;">last_match</code> and
<code style="font-size: 18px !important; line-height: 25.2px !important;">direction</code> to their initial values to get ready for the next search operation.</p>

<p style="font-size: 18px !important; line-height: 25.2px !important;">Now that we have those variables all set up, let’s put them to use.</p>

<div class="diff" style="font-size: 18px !important; line-height: 25.2px !important;">
<div class="diff-header" style="font-size: 16px !important; line-height: 25.2px !important;">
  <div class="step-filename" style="font-size: 16px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/blob/search-arrows/kilo.c" style="font-size: 16px !important; line-height: 25.2px !important;">kilo.c</a></div>
  <div class="step-number" style="font-size: 16px !important; line-height: 25.2px !important;">Step 140</div>
  <div class="step-name" style="font-size: 12px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/tree/search-arrows" style="font-size: 12px !important; line-height: 25.2px !important;">search-arrows</a></div>
</div><pre class="highlight" style="font-size: 18px !important; line-height: 25.2px !important;"><code style="font-size: 14px !important; line-height: 20px !important;"><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** includes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** defines ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** data ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** prototypes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** terminal ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** row operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** editor operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** file i/o ***/</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** find ***/</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorFindCallback</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">static</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">last_match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span><span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">static</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">direction</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'\r'</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">||</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="sc" style="font-size: 14px !important; line-height: 20px !important;">'\x1b'</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">last_match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span><span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">direction</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">return</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">else</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">ARROW_RIGHT</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">||</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">ARROW_DOWN</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">direction</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">else</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">ARROW_LEFT</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">||</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">ARROW_UP</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">direction</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span><span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">else</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">last_match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span><span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">direction</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">last_match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span><span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">direction</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">current</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">last_match</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">for</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">0</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&lt;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">numrows</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">i</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">++</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">current</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">+=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">direction</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">current</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span><span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">current</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">numrows</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">1</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">else</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">current</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">==</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">numrows</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">current</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="mi" style="font-size: 14px !important; line-height: 20px !important;">0</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important;"></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">erow</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">&amp;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">[</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">current</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">];</span></ins><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">strstr</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">-&gt;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">render</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">match</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">last_match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">current</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cy</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">current</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></ins><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorRowRxToCx</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">match</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">-</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">row</span><span class="o" style="font-size: 14px !important; line-height: 20px !important;">-&gt;</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">render</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">rowoff</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">numrows</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">      <span class="k" style="font-size: 14px !important; line-height: 20px !important;">break</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorFind</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">()</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** append buffer ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** output ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** input ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** init ***/</span></div></code></pre>
<div class="diff-footer" style="font-size: 18px !important; line-height: 25.2px !important;">
  <div class="diff-tag-c2" style="font-size: 12px !important; line-height: 16px !important;">♐︎ compiles</div>
</div>
</div>


<p style="font-size: 18px !important; line-height: 25.2px !important;"><code style="font-size: 18px !important; line-height: 25.2px !important;">current</code> is the index of the current row we are searching. If there was a last
match, it starts on the line after (or before, if we’re searching backwards).
If there wasn’t a last match, it starts at the top of the file and searches in
the forward direction to find the first match.</p>

<p style="font-size: 18px !important; line-height: 25.2px !important;">The <code style="font-size: 18px !important; line-height: 25.2px !important;">if ... else if</code> causes <code style="font-size: 18px !important; line-height: 25.2px !important;">current</code> to go from the end of the file back to
the beginning of the file, or vice versa, to allow a search to “wrap around”
the end of a file and continue from the top (or bottom).</p>

<p style="font-size: 18px !important; line-height: 25.2px !important;">When we find a match, we set <code style="font-size: 18px !important; line-height: 25.2px !important;">last_match</code> to <code style="font-size: 18px !important; line-height: 25.2px !important;">current</code>, so that if the user
presses the arrow keys, we’ll start the next search from that point.</p>

<p style="font-size: 18px !important; line-height: 25.2px !important;">Finally, let’s not forget to update the prompt text to let the user know they
can use the arrow keys.</p>

<div class="diff" style="font-size: 18px !important; line-height: 25.2px !important;">
<div class="diff-header" style="font-size: 16px !important; line-height: 25.2px !important;">
  <div class="step-filename" style="font-size: 16px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/blob/search-arrows-help/kilo.c" style="font-size: 16px !important; line-height: 25.2px !important;">kilo.c</a></div>
  <div class="step-number" style="font-size: 16px !important; line-height: 25.2px !important;">Step 141</div>
  <div class="step-name" style="font-size: 12px !important; line-height: 25.2px !important;"><a href="https://github.com/snaptoken/kilo-src/tree/search-arrows-help" style="font-size: 12px !important; line-height: 25.2px !important;">search-arrows-help</a></div>
</div><pre class="highlight" style="font-size: 18px !important; line-height: 25.2px !important;"><code style="font-size: 14px !important; line-height: 20px !important;"><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** includes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** defines ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** data ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** prototypes ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** terminal ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** row operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** editor operations ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** file i/o ***/</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** find ***/</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorFindCallback</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span> <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">key</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span> … <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="kt" style="font-size: 14px !important; line-height: 20px !important;">void</span> <span class="nf" style="font-size: 14px !important; line-height: 20px !important;">editorFind</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">()</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">saved_cx</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">saved_cy</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cy</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">saved_coloff</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">coloff</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">int</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">saved_rowoff</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">rowoff</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important;"></div><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="kt" style="font-size: 14px !important; line-height: 20px !important;">char</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">*</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorPrompt</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="s" style="font-size: 14px !important; line-height: 20px !important;">"Search: %s (Use ESC/Arrows/Enter)"</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">,</span></ins><ins class="line" style="font-size: 14px !important; line-height: 20px !important;">                             <span class="n" style="font-size: 14px !important; line-height: 20px !important;">editorFindCallback</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></ins><div class="line" style="font-size: 14px !important;"></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="k" style="font-size: 14px !important; line-height: 20px !important;">if</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">)</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">free</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">(</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">query</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">);</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span> <span class="k" style="font-size: 14px !important; line-height: 20px !important;">else</span> <span class="p" style="font-size: 14px !important; line-height: 20px !important;">{</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cx</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">saved_cx</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">cy</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">saved_cy</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">coloff</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">saved_coloff</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">    <span class="n" style="font-size: 14px !important; line-height: 20px !important;">E</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">.</span><span class="n" style="font-size: 14px !important; line-height: 20px !important;">rowoff</span> <span class="o" style="font-size: 14px !important; line-height: 20px !important;">=</span> <span class="n" style="font-size: 14px !important; line-height: 20px !important;">saved_rowoff</span><span class="p" style="font-size: 14px !important; line-height: 20px !important;">;</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;">  <span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important; line-height: 20px !important;"><span class="p" style="font-size: 14px !important; line-height: 20px !important;">}</span></div><div class="line" style="font-size: 14px !important;"></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** append buffer ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** output ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** input ***/</span></div><div class="line folded" style="font-size: 14px !important; line-height: 20px !important;"><span class="cm" style="font-size: 14px !important; line-height: 20px !important;">/*** init ***/</span></div></code></pre>
<div class="diff-footer" style="font-size: 18px !important; line-height: 25.2px !important;">
  <div class="diff-tag-c2" style="font-size: 12px !important; line-height: 16px !important;">♐︎ compiles</div>
</div>
</div>


<p style="font-size: 18px !important; line-height: 25.2px !important;">In the <a href="https://viewsourcecode.org/snaptoken/kilo/07.syntaxHighlighting.html" style="font-size: 18px !important; line-height: 25.2px !important;">next chapter</a>, we’ll implement syntax
highlighting and filetype detection, to complete our text editor.</p>

    </div>
    <div id="version" style="font-size: 12px !important; line-height: 25.2px !important;">
      <a href="https://github.com/snaptoken/kilo-tutorial/tree/v1.0.0beta11" style="font-size: 12px !important; line-height: 25.2px !important;">1.0.0beta11</a>
      (<a href="https://github.com/snaptoken/kilo-tutorial/blob/master/CHANGELOG.md" style="font-size: 12px !important; line-height: 25.2px !important;">changelog</a>)
    </div>
    <footer class="bar" style="font-size: 18px !important; line-height: 25.2px !important;">
      <nav style="font-size: 18px !important; line-height: 25.2px !important;">
        <a href="#" style="font-size: 18px !important; line-height: 25.2px !important;">top of page</a>
      </nav>
    </footer>
  


</body><grammarly-desktop-integration data-grammarly-shadow-root="true"></grammarly-desktop-integration></html>